{
  "code": "import { lwg } from \"../Lwg_Template/lwg\";\r\nimport ADManager, { TaT } from \"../../TJ/Admanager\";\r\nimport RecordManager from \"../../TJ/RecordManager\";\r\nexport default class UIVictory extends lwg.Admin.Scene {\r\n    constructor() { super(); }\r\n    lwgInit() {\r\n        ADManager.ShowNormal();\r\n        RecordManager.stopAutoRecord();\r\n        this.BtnGoldAdv = this.self['BtnGoldAdv'];\r\n        this.BtnExAdv = this.self['BtnExAdv'];\r\n        this.GetGold = this.self['GetGold'];\r\n        this.LvNum = this.self['LvNum'];\r\n        this.LvNum.value = lwg.Global._gameLevel.toString();\r\n        this.BtnNext = this.self['BtnNext'];\r\n        this.getGoldDisplay();\r\n        this.LvNumDisplay();\r\n        lwg.PalyAudio.playSound(lwg.Enum.voiceUrl.victory, 1);\r\n        if (lwg.Global._hotShare && lwg.Global._gameLevel !== 1) {\r\n            lwg.Admin._openScene(lwg.Admin.SceneName.UIShare, null, null, null);\r\n        }\r\n        if (!lwg.Global._elect) {\r\n            this.self['P201_01'].removeSelf();\r\n            this.self['P201_02'].removeSelf();\r\n        }\r\n        if (lwg.Admin.openLevelNum >= lwg.Global._gameLevel) {\r\n            lwg.Global._gameLevel++;\r\n            lwg.LocalStorage.addData();\r\n        }\r\n    }\r\n    adaptive() {\r\n        this.self['sceneContent'].y = Laya.stage.height / 2;\r\n    }\r\n    openAni() {\r\n        lwg.Effects.createFireworks(this.self['sceneContent'], 30, 430, 40);\r\n        lwg.Effects.createFireworks(this.self['sceneContent'], 30, 109, 49.5);\r\n        lwg.Effects.createLeftOrRightJet(this.self['sceneContent'], 'right', 30, 582, 141.5);\r\n        lwg.Effects.createLeftOrRightJet(this.self['sceneContent'], 'left', 30, -21.5, 141.5);\r\n        this.BtnNext.visible = false;\r\n        setTimeout(() => {\r\n            this.BtnNext.visible = true;\r\n        }, lwg.Global._btnDelayed);\r\n        this.self['BtnBack'].visible = false;\r\n    }\r\n    getGoldAni(number, thisFunc) {\r\n        let x = this.self['GetGold'].x + this.self['sceneContent'].x - this.self['sceneContent'].width / 2;\r\n        let y = this.self['GetGold'].y + this.self['sceneContent'].y - this.self['sceneContent'].height / 2;\r\n        for (let index = 0; index < number; index++) {\r\n            lwg.Effects.createAddGold(Laya.stage, index, x, y, lwg.Global.GoldNumNode.x - 53, lwg.Global.GoldNumNode.y - 12, f => {\r\n                let Num = lwg.Global.GoldNumNode.getChildByName('Num');\r\n                Num.value = (Number(Num.value) + 1).toString();\r\n                let goldNum = this.self['GoldNum'];\r\n                goldNum.value = 'x' + (number - index - 2);\r\n                if (index === number - 1) {\r\n                    if (thisFunc !== null) {\r\n                        thisFunc();\r\n                    }\r\n                }\r\n            });\r\n        }\r\n    }\r\n    getGoldDisplay() {\r\n        let goldNum = this.GetGold.getChildByName('GoldNum');\r\n        goldNum.value = 'x' + 25;\r\n        lwg.Global._goldNum += 25;\r\n        lwg.LocalStorage.addData();\r\n    }\r\n    LvNumDisplay() {\r\n        if (lwg.Admin.openLevelNum >= lwg.Global._gameLevel) {\r\n            this.LvNum.value = lwg.Global._gameLevel.toString();\r\n        }\r\n        else {\r\n            this.LvNum.value = lwg.Admin.openLevelNum.toString();\r\n        }\r\n    }\r\n    btnOnClick() {\r\n        ADManager.TAPoint(TaT.BtnShow, 'ADrewardbt_success');\r\n        ADManager.TAPoint(TaT.BtnShow, 'Share_success');\r\n        ADManager.TAPoint(TaT.BtnShow, 'nextword_success');\r\n        ADManager.TAPoint(TaT.BtnShow, 'ADticketbt_success');\r\n        lwg.Click.on(lwg.Click.ClickType.largen, null, this.BtnGoldAdv, this, null, null, this.btnGoldAdvUp, null);\r\n        lwg.Click.on(lwg.Click.ClickType.largen, null, this.BtnNext, this, null, null, this.btnNextUp, null);\r\n        lwg.Click.on(lwg.Click.ClickType.largen, null, this.self['BtnShare'], this, null, null, this.btnShareUp, null);\r\n    }\r\n    btnOffClick() {\r\n        lwg.Click.off(lwg.Click.ClickType.largen, this.BtnNext, this, null, null, this.btnNextUp, null);\r\n        lwg.Click.off(lwg.Click.ClickType.largen, this.BtnGoldAdv, this, null, null, this.btnGoldAdvUp, null);\r\n        lwg.Click.off(lwg.Click.ClickType.largen, this.self['BtnShare'], this, null, null, this.btnShareUp, null);\r\n    }\r\n    btnNextUp(event) {\r\n        ADManager.TAPoint(TaT.BtnClick, 'nextword_success');\r\n        event.currentTarget.scale(1, 1);\r\n        this.btnOffClick();\r\n        if (this.goldAdv_3Get) {\r\n            this.getGoldAniFunc();\r\n        }\r\n        else {\r\n            this.getGoldAni(15, f => {\r\n                this.getGoldAniFunc();\r\n                let Num = lwg.Global.GoldNumNode.getChildByName('Num');\r\n                Num.value = (Number(Num.value) + 10).toString();\r\n            });\r\n        }\r\n    }\r\n    getGoldAniFunc() {\r\n        lwg.Admin._closeCustomScene();\r\n        if (lwg.Global._watchAdsNum < 3) {\r\n            lwg.Admin._openScene(lwg.Admin.SceneName.UIXDpifu, null, null, null);\r\n        }\r\n        else {\r\n            lwg.Admin._openScene(lwg.Admin.SceneName.UIStart, null, null, f => { });\r\n        }\r\n        this.self.close();\r\n    }\r\n    btnGoldAdvUp(event) {\r\n        ADManager.TAPoint(TaT.BtnClick, 'ADrewardbt_success');\r\n        event.currentTarget.scale(1, 1);\r\n        ADManager.ShowReward(() => {\r\n            this.btnGoldAdvUpFunc();\r\n        });\r\n    }\r\n    btnGoldAdvUpFunc() {\r\n        let btnpic = this.BtnGoldAdv.getChildByName('btnpic');\r\n        let iconpic = this.BtnGoldAdv.getChildByName('iconpic');\r\n        btnpic.skin = 'UI_new/Victory/rede_btn_01.png';\r\n        iconpic.skin = 'UI_new/Victory/icon_adv_h.png';\r\n        this.btnOffClick();\r\n        let goldNum = this.GetGold.getChildByName('GoldNum');\r\n        goldNum.value = 'x' + 75;\r\n        let Num = lwg.Global.GoldNumNode.getChildByName('Num');\r\n        Num.value = (Number(Num.value) + 60).toString();\r\n        this.goldAdv_3Get = true;\r\n        this.getGoldAni(15, fun => {\r\n            lwg.Global._goldNum += 25 * 2;\r\n            lwg.LocalStorage.addData();\r\n            lwg.Click.on(lwg.Click.ClickType.largen, null, this.BtnNext, this, null, null, this.btnNextUp, null);\r\n            lwg.Click.on(lwg.Click.ClickType.largen, null, this.self['BtnBack'], this, null, null, this.btnBackUp, null);\r\n            lwg.Click.on(lwg.Click.ClickType.largen, null, this.self['BtnShare'], this, null, null, this.btnShareUp, null);\r\n            goldNum.value = 'x' + 0;\r\n        });\r\n    }\r\n    btnBackUp(event) {\r\n        ADManager.TAPoint(TaT.BtnClick, 'ADticketbt_success');\r\n        event.currentTarget.scale(1, 1);\r\n        this.btnOffClick();\r\n        if (this.goldAdv_3Get) {\r\n            this.btnBackUpFunc();\r\n        }\r\n        else {\r\n            this.getGoldAni(15, f => {\r\n                this.btnBackUpFunc();\r\n                let Num = lwg.Global.GoldNumNode.getChildByName('Num');\r\n                Num.value = (Number(Num.value) + 10).toString();\r\n            });\r\n        }\r\n    }\r\n    btnBackUpFunc() {\r\n        lwg.Admin._openScene('UIStart', null, null, null);\r\n        lwg.Admin._closeCustomScene();\r\n        lwg.LocalStorage.addData();\r\n        this.self.close();\r\n        lwg.LocalStorage.addData();\r\n    }\r\n    btnShareUp(event) {\r\n        ADManager.TAPoint(TaT.BtnClick, 'Share_success');\r\n        event.currentTarget.scale(1, 1);\r\n        RecordManager._share('noAward', () => {\r\n            this.btnShareUpFunc();\r\n        });\r\n    }\r\n    btnShareUpFunc() {\r\n        console.log('分享成功，只是没有奖励！');\r\n    }\r\n    lwgDisable() {\r\n        Laya.timer.clearAll(this);\r\n        Laya.Tween.clearAll(this);\r\n    }\r\n}\r\n",
  "references": [
    "D:/Game/project/Riddle/Riddle1/TJ3Demo_Promo/src/script/Lwg_Template/lwg.ts",
    "D:/Game/project/Riddle/Riddle1/TJ3Demo_Promo/src/TJ/Admanager.ts",
    "D:/Game/project/Riddle/Riddle1/TJ3Demo_Promo/src/TJ/RecordManager.ts"
  ]
}
