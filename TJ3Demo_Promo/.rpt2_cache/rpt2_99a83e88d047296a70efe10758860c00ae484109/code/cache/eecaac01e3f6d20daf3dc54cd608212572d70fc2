{
  "code": "export default class RotateSelfPro extends Laya.Script {\r\n    constructor() {\r\n        super(...arguments);\r\n        this.speed = 2;\r\n        this.targetSpeed = 2;\r\n        this.reducespeed = 0;\r\n        this.degree = 0;\r\n        this.start = 0;\r\n        this.lastzhizhen = 0;\r\n        this.TargetAngle = 0;\r\n        this.TargetTurn = 0;\r\n        this.IsLeft = true;\r\n        this.RoteCut = 1;\r\n        this.RoteSpeed = 2;\r\n    }\r\n    onAwake() {\r\n        this.zhuanpanParent = this.owner;\r\n        this.ZhunpanBg = this.zhuanpanParent.getChildByName(\"ZhunpanBG\");\r\n        this.zhizhen = this.zhuanpanParent.getChildByName(\"ZhiZhen\");\r\n        this.zhizhen.rotation = 0;\r\n        this.speed = 0.02;\r\n        this.lastzhizhen = -1;\r\n    }\r\n    OpenZhiZhen() {\r\n        Laya.timer.loop(1, this, this.FixedUpdate);\r\n    }\r\n    AddSpeed() {\r\n        this.speed = 0;\r\n        this.reducespeed = 0;\r\n        this.RoteSpeed = 3;\r\n        console.log(\"添加转速\");\r\n        let a = this.ZhunpanBg.rotation;\r\n        console.log(\"初始角度\" + a);\r\n        a = a % 360;\r\n        console.log(\"初始角度\" + a);\r\n        if (a > 60) {\r\n            a -= 360;\r\n        }\r\n        this.TargetTurn = 0;\r\n        this.startStop = false;\r\n        this.ZhunpanBg.rotation = a;\r\n        console.log(this.ZhunpanBg.rotation);\r\n        this.reducespeed = 0;\r\n        Laya.timer.loop(1, this, this.SpeedUp);\r\n        Laya.timer.loop(1, this, this.ZhiZhenMove);\r\n    }\r\n    StopSpeed(_degree, _action) {\r\n        console.log(\"转盘停止 开始减速\" + _degree);\r\n        Laya.timer.clear(this, this.SpeedUp);\r\n        this.degree = _degree;\r\n        this.degree %= 360;\r\n        this.action = _action;\r\n        this.reducespeed = 0.2;\r\n        this.RoteSpeed = 1;\r\n        console.log(\"转盘停止2 目标角度\", this.degree);\r\n    }\r\n    FixedUpdate() {\r\n        if (this.startStop) {\r\n            return;\r\n        }\r\n        if (this.speed > 4) {\r\n            this.speed -= this.reducespeed;\r\n        }\r\n        this.ZhunpanBg.rotation += this.speed;\r\n        if (this.ZhunpanBg.rotation > 360) {\r\n            this.ZhunpanBg.rotation %= 360;\r\n            this.TargetTurn++;\r\n            if (this.TargetTurn > 3) {\r\n                let a = this.ZhunpanBg.rotation;\r\n                let b = this.degree;\r\n                let c = Math.abs((a - b) / 360);\r\n                Laya.timer.clear(this, this.ZhiZhenMove);\r\n                Laya.timer.loop(1, this, this.ZhizhenStop);\r\n                Laya.Tween.to(this.ZhunpanBg, { rotation: this.degree }, c * 2500, Laya.Ease.linearNone, Laya.Handler.create(this, () => {\r\n                    this.action();\r\n                }));\r\n                this.startStop = true;\r\n            }\r\n        }\r\n        if (this.lastzhizhen != Math.ceil((this.ZhunpanBg.rotation + 30) / 60)) {\r\n            this.lastzhizhen = (Math.ceil((this.ZhunpanBg.rotation + 30) / 60));\r\n        }\r\n    }\r\n    onStart() {\r\n    }\r\n    SpeedDown() {\r\n    }\r\n    SpeedUp() {\r\n        this.speed += 0.5;\r\n        if (this.speed >= 8) {\r\n            Laya.timer.clear(this, this.SpeedUp);\r\n        }\r\n    }\r\n    ZhizhenStop() {\r\n        if (this.zhizhen.rotation < 0) {\r\n            this.zhizhen.rotation += 0.2;\r\n        }\r\n        else {\r\n            Laya.timer.clearAll(this);\r\n            console.log(\"消除所有\");\r\n        }\r\n    }\r\n    ZhiZhenMove() {\r\n        if (this.IsLeft) {\r\n            this.zhizhen.rotation -= this.RoteSpeed;\r\n            if (this.zhizhen.rotation <= -12) {\r\n                this.IsLeft = !this.IsLeft;\r\n            }\r\n        }\r\n        else {\r\n            this.zhizhen.rotation += this.RoteSpeed;\r\n            if (this.zhizhen.rotation >= 1) {\r\n                this.IsLeft = !this.IsLeft;\r\n            }\r\n        }\r\n    }\r\n}\r\n",
  "references": []
}
