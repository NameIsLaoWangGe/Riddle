{
  "code": "import { lwg } from \"../Lwg_Template/lwg\";\r\nimport ADManager, { TaT } from \"../../TJ/Admanager\";\r\nexport default class UIVictoryBox extends lwg.Admin.Scene {\r\n    constructor() {\r\n        super();\r\n        this.getNum = 3;\r\n        this.ranArray = [];\r\n        this.maxAdvGet = 6;\r\n    }\r\n    selfVars() {\r\n        this.BoxList = this.self['BoxList'];\r\n    }\r\n    lwgInit() {\r\n        lwg.Global._victoryBoxNum++;\r\n        ADManager.TAPoint(TaT.BtnShow, 'ADrewardbt_box');\r\n        this.randomAdvBox();\r\n        this.createBoxList();\r\n        this.self['BtnAgain'].visible = false;\r\n        this.self['BtnNo'].visible = false;\r\n    }\r\n    adaptive() {\r\n        this.self['SceneContent'].y = Laya.stage.height / 2;\r\n    }\r\n    randomAdvBox() {\r\n        let arr = [0, 1, 2, 3, 4, 5, 6, 7, 8];\r\n        let ran1 = Math.floor(Math.random() * (arr.length - 1));\r\n        let a1 = arr[ran1];\r\n        arr.splice(ran1, 1);\r\n        console.log('1', arr);\r\n        let ran2 = Math.floor(Math.random() * (arr.length - 1));\r\n        let a2 = arr[ran2];\r\n        arr.splice(ran2, 1);\r\n        console.log('2', arr);\r\n        let ran3 = Math.floor(Math.random() * (arr.length - 1));\r\n        let a3 = arr[ran3];\r\n        this.ranArray = [a1, a2, a3];\r\n    }\r\n    createBoxList() {\r\n        this.BoxList.spaceX = 36;\r\n        this.BoxList.spaceY = 20;\r\n        this.BoxList.selectHandler = new Laya.Handler(this, this.onSelect_List);\r\n        this.BoxList.renderHandler = new Laya.Handler(this, this.updateItem);\r\n        this.refreshListData();\r\n        this.listOpenAni();\r\n    }\r\n    listOpenAni() {\r\n    }\r\n    refreshListData() {\r\n        var data = [];\r\n        for (var m = 0; m < 9; m++) {\r\n            let pic_Gold = false;\r\n            let num = Math.floor(Math.random() * 10) + 5;\r\n            let pic_Box = true;\r\n            let index = m.toString();\r\n            let adv = false;\r\n            if (lwg.Global._victoryBoxNum !== 1) {\r\n                for (let index = 0; index < this.ranArray.length; index++) {\r\n                    if (m === this.ranArray[index]) {\r\n                        adv = true;\r\n                        break;\r\n                    }\r\n                }\r\n            }\r\n            data.push({\r\n                pic_Gold,\r\n                num,\r\n                pic_Box,\r\n                index,\r\n                adv\r\n            });\r\n        }\r\n        this.BoxList.array = data;\r\n    }\r\n    onSelect_List(index) {\r\n    }\r\n    updateItem(cell, index) {\r\n        let dataSource = cell.dataSource;\r\n        let Pic_Gold = cell.getChildByName('Pic_Gold');\r\n        Pic_Gold.visible = dataSource.pic_Gold;\r\n        let Num = cell.getChildByName('Num');\r\n        Num.text = dataSource.num;\r\n        Num.visible = Pic_Gold.visible;\r\n        let Pic_Box = cell.getChildByName('Pic_Box');\r\n        Pic_Box.visible = dataSource.pic_Box;\r\n        if (dataSource.adv) {\r\n            Pic_Box.skin = 'UI_new/VictoryBox/icon_advbox.png';\r\n        }\r\n        else {\r\n            Pic_Box.skin = 'UI_new/VictoryBox/icon_chai.png';\r\n        }\r\n        cell.name = dataSource.index;\r\n    }\r\n    btnOnClick() {\r\n        lwg.Click.on('largen', null, this.self['BtnNo'], this, null, null, this.btnNoUp, null);\r\n        lwg.Click.on('largen', null, this.self['BtnAgain'], this, null, null, this.btnAgainUp, null);\r\n    }\r\n    btnOffClick() {\r\n        lwg.Click.off('largen', this.self['BtnNo'], this, null, null, this.btnNoUp, null);\r\n        lwg.Click.off('largen', this.self['BtnAgain'], this, null, null, this.btnAgainUp, null);\r\n    }\r\n    btnNoUp(event) {\r\n        event.currentTarget.scale(1, 1);\r\n        lwg.Admin._openScene(lwg.Admin.SceneName.UIVictory, null, null, null);\r\n        this.self.close();\r\n    }\r\n    btnAgainUp(event) {\r\n        ADManager.TAPoint(TaT.BtnClick, 'ADrewardbt_box');\r\n        event.currentTarget.scale(1, 1);\r\n        if (this.maxAdvGet <= 0) {\r\n            lwg.Global._createHint_01(lwg.Enum.HintType.noGetNum);\r\n        }\r\n        else {\r\n            ADManager.ShowReward(() => {\r\n                lwg.Global._createHint_01(lwg.Enum.HintType.getBoxOne);\r\n                this.getNum += 3;\r\n                this.maxAdvGet -= 3;\r\n                this.self['BtnAgain'].visible = false;\r\n                this.self['BtnNo'].visible = false;\r\n            });\r\n        }\r\n    }\r\n    lwgOnUpdta() {\r\n        if (this.getNum > 0) {\r\n            this.self['BtnAgain'].visible = false;\r\n            this.self['BtnNo'].visible = false;\r\n        }\r\n        else {\r\n            this.self['BtnAgain'].visible = true;\r\n            this.self['BtnNo'].visible = true;\r\n        }\r\n    }\r\n    lwgDisable() {\r\n        Laya.timer.clearAll(this);\r\n        Laya.Tween.clearAll(this);\r\n    }\r\n}\r\n",
  "references": [
    "D:/Game/project/Riddle/Riddle1/TJ3Demo_Promo/src/script/Lwg_Template/lwg.ts",
    "D:/Game/project/Riddle/Riddle1/TJ3Demo_Promo/src/TJ/Admanager.ts"
  ]
}
