{
  "code": "import { lwg, Animation, Effects } from \"../Lwg_Template/lwg\";\r\nimport ADManager, { TaT } from \"../../TJ/Admanager\";\r\nexport default class UIStart extends lwg.Admin.Scene {\r\n    constructor() {\r\n        super();\r\n        this.listWPos = new Laya.Point();\r\n        this.moveSwitch = false;\r\n        this.btnPainted = false;\r\n        this.btnPifu = false;\r\n    }\r\n    selfVars() {\r\n        this.CustomsList = this.self['CustomsList'];\r\n        this.SceneContent = this.self['SceneContent'];\r\n        this.BtnStart = this.self['BtnStart'];\r\n        this.BtnPifu = this.self['BtnPifu'];\r\n        this.BtnLocation = this.self['BtnLocation'];\r\n    }\r\n    lwgInit() {\r\n        lwg.Global._stageClick = false;\r\n        ADManager.TAPoint(TaT.BtnShow, 'startbt_main');\r\n        this.BtnLocation.visible = false;\r\n        if (lwg.Global._watchAdsNum >= 3) {\r\n            this.self['BtnXD'].removeSelf();\r\n        }\r\n        this.listWPos.x = this.CustomsList.x + this.SceneContent.x - this.SceneContent.width / 2;\r\n        this.listWPos.y = this.CustomsList.y + this.SceneContent.y - this.SceneContent.height / 2;\r\n        this.createCustomsList();\r\n        ADManager.TAPoint(TaT.BtnShow, 'startbt_main');\r\n        ADManager.ShowBanner();\r\n        if (!lwg.Global._elect) {\r\n            this.self['P201'].visible = false;\r\n            this.self['P204'].visible = false;\r\n        }\r\n        Laya.MouseManager.multiTouchEnabled = true;\r\n    }\r\n    adaptive() {\r\n        this.self['P201'].y = Laya.stage.height * 0.156;\r\n        this.SceneContent.y = Laya.stage.height - 75 - 80 - this.SceneContent.height / 2;\r\n    }\r\n    openAni() {\r\n        let time = 80;\r\n        let delayed = 100;\r\n        let zhuanpan = this.self['BtnTurntable'].getChildByName('zhuanpan');\r\n        Animation.drop_KickBack(this.self['BtnTurntable'], 0, -1200, this.self['BtnTurntable'].y, 30, time * 4, 0, f => {\r\n            Laya.timer.frameLoop(1, this, f => {\r\n                zhuanpan.rotation++;\r\n            });\r\n        });\r\n        let dan = this.self['BtnPainted'].getChildByName('dan');\r\n        Animation.drop_KickBack(this.self['BtnPainted'], 0, -1200, this.self['BtnPainted'].y, 30, time * 4, delayed * 2, f => {\r\n            Laya.timer.loop(3000, this, f => {\r\n                Animation.shookHead_Simple(dan, 10, time * 3, 0, f => { });\r\n            });\r\n            Laya.timer.loop(1500, this, f => {\r\n                let scope = 20;\r\n                let ranX;\r\n                if (Math.floor(Math.random() * 2) === 1) {\r\n                    ranX = this.self['BtnPainted'].width / 2 + Math.random() * scope;\r\n                }\r\n                else {\r\n                    ranX = this.self['BtnPainted'].width / 2 - Math.random() * scope;\r\n                }\r\n                let ranY;\r\n                if (Math.floor(Math.random() * 2) === 1) {\r\n                    ranY = this.self['BtnPainted'].height / 2 + Math.random() * scope - 25;\r\n                }\r\n                else {\r\n                    ranY = this.self['BtnPainted'].height / 2 - Math.random() * scope - 25;\r\n                }\r\n                Effects.createExplosion_Rotate(this.self['BtnPainted'], 10, ranX, ranY, 'star', 3, 15);\r\n            });\r\n        });\r\n        Animation.drop_KickBack(this.self['BtnPifu'], 0, -1200, this.self['BtnPifu'].y, 30, time * 4, delayed * 3, f => { });\r\n        if (this.self['BtnXD'].visible) {\r\n            let wordXd = this.self['BtnXD'].getChildByName('wordXd');\r\n            let wordXd_01 = this.self['BtnXD'].getChildByName('wordXd_01');\r\n            wordXd_01.alpha = 0;\r\n            wordXd.alpha = 0;\r\n            Animation.drop_KickBack(this.self['BtnXD'], 0, -1200, this.self['BtnXD'].y, 30, time * 4, delayed * 1, f => {\r\n                wordXd.alpha = 1;\r\n                lwg.Animation.move_Scale(wordXd, 1, 200, 75, 99, 59, 2, time * 3, 200, f => {\r\n                    lwg.Animation.move_Scale(wordXd, wordXd.scaleX, wordXd.x, wordXd.y, 68, 73, 1, time * 0.7, 0, f => {\r\n                        wordXd.removeSelf();\r\n                        wordXd_01.alpha = 1;\r\n                        lwg.Animation.rotate_Scale(this.self['BtnXD'], 0, 1, 1, 0, 0.88, 0.88, time * 1.2, 0, f => {\r\n                            lwg.Global._stageClick = true;\r\n                        });\r\n                    });\r\n                });\r\n            });\r\n        }\r\n        Animation.bombs_Appear(this.BtnStart, 0, 1, 1.1, 0, time * 3, time, delayed, null, f => {\r\n            Animation.swell_shrink(this.BtnStart, 1, 1.1, time * 1.5, delayed, f => {\r\n                Laya.timer.loop(3000, this, f => {\r\n                    Animation.swell_shrink(this.BtnStart, 1, 1.1, time * 1.5, delayed, f => {\r\n                    });\r\n                });\r\n            });\r\n        });\r\n        Animation.blink_FadeOut(lwg.Global.ExecutionNumNode, 0, 1, time * 5, delayed * 2, f => {\r\n        });\r\n        Animation.blink_FadeOut(lwg.Global.GoldNumNode, 0, 1, time * 5, delayed * 2, f => {\r\n        });\r\n        return time * 4;\r\n    }\r\n    createCustomsList() {\r\n        this.CustomsList.selectEnable = false;\r\n        this.CustomsList.vScrollBarSkin = \"\";\r\n        this.CustomsList.selectHandler = new Laya.Handler(this, this.onSelect_List);\r\n        this.CustomsList.renderHandler = new Laya.Handler(this, this.updateItem);\r\n        this.listFirstIndex = lwg.Global._gameLevel;\r\n        this.refreshListData();\r\n        this.listOpenAni();\r\n    }\r\n    listOpenAni() {\r\n        this.CustomsList.scrollTo(lwg.Global._CustomsNum);\r\n        this.CustomsList.tweenTo(this.listFirstIndex, 600, Laya.Handler.create(this, f => {\r\n            let cell = this.CustomsList.getCell(this.listFirstIndex);\r\n            cell.alpha = 1;\r\n            let pic = cell.getChildByName('pic');\r\n            if (this.listFirstIndex % 2 == 0) {\r\n                pic.skin = 'UI_new/GameStart/icon_box01_open.png';\r\n            }\r\n            else {\r\n                pic.skin = 'UI_new/GameStart/icon_box02_open.png';\r\n            }\r\n        }));\r\n    }\r\n    refreshListData() {\r\n        var data = [];\r\n        for (var index = 0; index < lwg.Global._CustomsNum; index++) {\r\n            let customNum = index;\r\n            let picUrl;\r\n            let offsetX;\r\n            if (index % 2 == 0) {\r\n                picUrl = 'UI_new/GameStart/icon_box01.png';\r\n                offsetX = 135;\r\n            }\r\n            else {\r\n                picUrl = 'UI_new/GameStart/icon_box02.png';\r\n                offsetX = 155;\r\n            }\r\n            let zOder = lwg.Global._CustomsNum - index;\r\n            let lock;\r\n            if (index >= lwg.Global._gameLevel) {\r\n                lock = false;\r\n            }\r\n            else {\r\n                lock = true;\r\n            }\r\n            data.push({\r\n                customNum,\r\n                picUrl,\r\n                offsetX,\r\n                zOder,\r\n                lock\r\n            });\r\n        }\r\n        this.CustomsList.array = data;\r\n    }\r\n    onSelect_List(index) {\r\n    }\r\n    updateItem(cell, index) {\r\n        let dataSource = cell.dataSource;\r\n        cell.zOrder = dataSource.zOder;\r\n        let pic = cell.getChildByName('pic');\r\n        pic.skin = dataSource.picUrl;\r\n        pic.x = dataSource.offsetX;\r\n        let num = pic.getChildByName('LvNum');\r\n        num.value = dataSource.customNum.toString();\r\n        let lock = pic.getChildByName('lock');\r\n        lock.visible = dataSource.lock;\r\n        cell.name = 'item' + dataSource.customNum;\r\n        if (index === this.listFirstIndex) {\r\n            cell.alpha = 0;\r\n        }\r\n        else {\r\n            cell.alpha = 1;\r\n        }\r\n        if (this.listFirstIndex > lwg.Global._gameLevel || this.listFirstIndex < lwg.Global._gameLevel - 3) {\r\n            this.BtnLocation.visible = true;\r\n        }\r\n        else {\r\n            this.BtnLocation.visible = false;\r\n        }\r\n    }\r\n    onStageMouseDown(e) {\r\n        if (!lwg.Global._stageClick || lwg.Global._openXD) {\r\n            return;\r\n        }\r\n        this.firstY = Laya.MouseManager.instance.mouseY;\r\n        this.moveSwitch = true;\r\n    }\r\n    onStageMouseUp() {\r\n        let y = Laya.MouseManager.instance.mouseY;\r\n        if (!this.moveSwitch) {\r\n            return;\r\n        }\r\n        let diffY = y - this.firstY;\r\n        if (diffY > 10) {\r\n            this.listFirstIndex -= 1;\r\n            if (this.listFirstIndex < 1) {\r\n                this.listFirstIndex = 1;\r\n            }\r\n            else {\r\n                this.createAddHouse();\r\n            }\r\n        }\r\n        else if (diffY < -10) {\r\n            this.listFirstIndex += 1;\r\n            if (this.listFirstIndex > lwg.Global._CustomsNum) {\r\n                this.listFirstIndex = lwg.Global._CustomsNum;\r\n            }\r\n            else {\r\n                this.creatSubHouse();\r\n            }\r\n        }\r\n        this.moveSwitch = false;\r\n        this.CustomsList.tweenTo(this.listFirstIndex, 100, Laya.Handler.create(this, f => { }));\r\n    }\r\n    createAddHouse() {\r\n        let time = 600;\r\n        let house = Laya.Pool.getItemByCreateFun('house', this.house.create, this.house);\r\n        this.SceneContent.addChild(house);\r\n        house.pos(this.CustomsList.x - 400, this.CustomsList.y - 300);\r\n        house['UIStart_House'].index = this.listFirstIndex;\r\n        lwg.Animation.move_Simple(house, house.x, house.y, this.CustomsList.x, this.CustomsList.y, time, 0, f => {\r\n            house.removeSelf();\r\n            let cell1 = this.CustomsList.getCell(house['UIStart_House'].index);\r\n            if (cell1) {\r\n                cell1.alpha = 1;\r\n                let pic1 = cell1.getChildByName('pic');\r\n                if (house['UIStart_House'].index <= lwg.Global._gameLevel) {\r\n                    if (house['UIStart_House'].index % 2 == 0) {\r\n                        pic1.skin = 'UI_new/GameStart/icon_box01_open.png';\r\n                    }\r\n                    else {\r\n                        pic1.skin = 'UI_new/GameStart/icon_box02_open.png';\r\n                    }\r\n                }\r\n                else {\r\n                    if (house['UIStart_House'].index % 2 == 0) {\r\n                        pic1.skin = 'UI_new/GameStart/icon_box01.png';\r\n                    }\r\n                    else {\r\n                        pic1.skin = 'UI_new/GameStart/icon_box02.png';\r\n                    }\r\n                }\r\n            }\r\n            let cell2 = this.CustomsList.getCell(house['UIStart_House'].index + 1);\r\n            if (cell2) {\r\n                let pic2 = cell2.getChildByName('pic');\r\n                if ((house['UIStart_House'].index + 1) % 2 === 0) {\r\n                    pic2.skin = 'UI_new/GameStart/icon_box01.png';\r\n                }\r\n                else {\r\n                    pic2.skin = 'UI_new/GameStart/icon_box02.png';\r\n                }\r\n            }\r\n        });\r\n        let pic = house.getChildByName('pic');\r\n        let lvNum = pic.getChildByName('LvNum');\r\n        lvNum.value = this.listFirstIndex.toString();\r\n        if (this.listFirstIndex <= lwg.Global._gameLevel) {\r\n            if (this.listFirstIndex % 2 == 0) {\r\n                pic.skin = 'UI_new/GameStart/icon_box01_open.png';\r\n                pic.x = 135;\r\n            }\r\n            else {\r\n                pic.skin = 'UI_new/GameStart/icon_box02_open.png';\r\n                pic.x = 155;\r\n            }\r\n        }\r\n        else {\r\n            if (this.listFirstIndex % 2 == 0) {\r\n                pic.skin = 'UI_new/GameStart/icon_box01.png';\r\n                pic.x = 135;\r\n            }\r\n            else {\r\n                pic.skin = 'UI_new/GameStart/icon_box02.png';\r\n                pic.x = 155;\r\n            }\r\n        }\r\n        let lock = pic.getChildByName('lock');\r\n        if (this.listFirstIndex >= lwg.Global._gameLevel) {\r\n            lock.visible = false;\r\n        }\r\n        else {\r\n            lock.visible = true;\r\n        }\r\n        lwg.Animation.simple_Rotate(pic, 250, 360, time, null);\r\n    }\r\n    creatSubHouse() {\r\n        let cell1 = this.CustomsList.getCell(this.listFirstIndex);\r\n        if (cell1) {\r\n            let pic = cell1.getChildByName('pic');\r\n            if (this.listFirstIndex <= lwg.Global._gameLevel) {\r\n                if (this.listFirstIndex % 2 == 0) {\r\n                    pic.skin = 'UI_new/GameStart/icon_box01_open.png';\r\n                    pic.x = 135;\r\n                }\r\n                else {\r\n                    pic.skin = 'UI_new/GameStart/icon_box02_open.png';\r\n                    pic.x = 155;\r\n                }\r\n            }\r\n            else {\r\n                if (this.listFirstIndex % 2 == 0) {\r\n                    pic.skin = 'UI_new/GameStart/icon_box01.png';\r\n                    pic.x = 135;\r\n                }\r\n                else {\r\n                    pic.skin = 'UI_new/GameStart/icon_box02.png';\r\n                    pic.x = 155;\r\n                }\r\n            }\r\n        }\r\n        let time = 1000;\r\n        let house = Laya.Pool.getItemByCreateFun('house', this.house.create, this.house);\r\n        this.SceneContent.addChild(house);\r\n        house.pos(this.CustomsList.x, this.CustomsList.y);\r\n        lwg.Animation.move_Simple(house, house.x, house.y, this.CustomsList.x + 800, this.CustomsList.y + 500, time, 0, f => {\r\n            house.removeSelf();\r\n        });\r\n        let pic = house.getChildByName('pic');\r\n        let lvNum = pic.getChildByName('LvNum');\r\n        lvNum.value = (this.listFirstIndex - 1).toString();\r\n        if (this.listFirstIndex <= lwg.Global._gameLevel) {\r\n            if (this.listFirstIndex % 2 == 0) {\r\n                pic.skin = 'UI_new/GameStart/icon_box01_open.png';\r\n                pic.x = 135;\r\n            }\r\n            else {\r\n                pic.skin = 'UI_new/GameStart/icon_box02_open.png';\r\n                pic.x = 155;\r\n            }\r\n        }\r\n        else {\r\n            if (this.listFirstIndex % 2 == 0) {\r\n                pic.skin = 'UI_new/GameStart/icon_box01.png';\r\n                pic.x = 135;\r\n            }\r\n            else {\r\n                pic.skin = 'UI_new/GameStart/icon_box02.png';\r\n                pic.x = 155;\r\n            }\r\n        }\r\n        let lock = pic.getChildByName('lock');\r\n        if (this.listFirstIndex >= lwg.Global._gameLevel) {\r\n            lock.visible = false;\r\n        }\r\n        else {\r\n            lock.visible = true;\r\n        }\r\n        lwg.Animation.simple_Rotate(pic, 0, 180, time, null);\r\n    }\r\n    btnOnClick() {\r\n        lwg.Click.on(lwg.Click.ClickType.largen, null, this.BtnStart, this, null, null, this.btnStartClickUp, null);\r\n        lwg.Click.on(lwg.Click.ClickType.noEffect, null, this.BtnLocation, this, null, null, this.btnLocationUp, null);\r\n        lwg.Click.on(lwg.Click.ClickType.noEffect, null, this.CustomsList, this, null, null, this.customsListUp, null);\r\n        lwg.Click.on(lwg.Click.ClickType.largen, null, this.self['BtnXD'], this, null, null, this.btnXDUp, null);\r\n        lwg.Click.on(lwg.Click.ClickType.largen, null, this.self['BtnSet'], this, null, null, this.btnSetUp, null);\r\n        lwg.Click.on(lwg.Click.ClickType.largen, null, this.self['BtnPainted'], this, this.btnPaintedDown, null, this.btnPaintedUp, null);\r\n        lwg.Click.on(lwg.Click.ClickType.largen, null, this.BtnPifu, this, this.btnPifuDown, null, this.btnPifuUp, null);\r\n        lwg.Click.on(lwg.Click.ClickType.largen, null, this.self['BtnTurntable'], this, null, null, this.btnTurntableUp, null);\r\n    }\r\n    btnPaintedDown(e) {\r\n        e.stopPropagation();\r\n        if (lwg.Global._haimiangongzhu) {\r\n            return;\r\n        }\r\n        e.currentTarget.scale(1.1, 1.1);\r\n        this.btnPainted = true;\r\n    }\r\n    btnPaintedUp(e) {\r\n        e.currentTarget.scale(1, 1);\r\n        if (!this.candanFunc()) {\r\n            lwg.Admin._openScene(lwg.Admin.SceneName.UICaiDanQiang, null, null, null);\r\n        }\r\n        this.btnPainted = false;\r\n        this.btnPifu = false;\r\n    }\r\n    btnPifuDown(e) {\r\n        e.stopPropagation();\r\n        if (lwg.Global._haimiangongzhu) {\r\n            return;\r\n        }\r\n        e.currentTarget.scale(1.1, 1.1);\r\n        this.btnPifu = true;\r\n    }\r\n    btnPifuUp(event) {\r\n        event.currentTarget.scale(1, 1);\r\n        if (!this.candanFunc()) {\r\n            lwg.Admin._openScene('UIPifu', null, null, null);\r\n        }\r\n        this.btnPainted = false;\r\n        this.btnPifu = false;\r\n    }\r\n    candanFunc() {\r\n        if (this.btnPainted && this.btnPifu) {\r\n            lwg.Admin._openScene(lwg.Admin.SceneName.UICaidanPifu, null, null, f => {\r\n                this.btnPainted = false;\r\n                this.btnPifu = false;\r\n            });\r\n            return true;\r\n        }\r\n        else {\r\n            return false;\r\n        }\r\n    }\r\n    btnTurntableUp(e) {\r\n        e.currentTarget.scale(1, 1);\r\n        lwg.Admin._openScene(lwg.Admin.SceneName.UITurntable, null, null, null);\r\n    }\r\n    btnSetUp() {\r\n        lwg.Admin._openScene(lwg.Admin.SceneName.UISet, null, null, null);\r\n    }\r\n    btnXDUp() {\r\n        lwg.Admin._openScene(lwg.Admin.SceneName.UIXDpifu, null, null, null);\r\n    }\r\n    btnStartClickUp(event) {\r\n        ADManager.TAPoint(TaT.BtnClick, 'startbt_main');\r\n        event.currentTarget.scale(1, 1);\r\n        if (this.listFirstIndex > lwg.Global._gameLevel) {\r\n            lwg.Global._createHint_01(lwg.Enum.HintType.nopass);\r\n        }\r\n        else {\r\n            if (lwg.Global._execution < 2) {\r\n                lwg.Admin._openScene('UIExecutionHint', null, null, null);\r\n            }\r\n            else {\r\n                if (lwg.Global._havePifu.length < 7) {\r\n                    if (this.listFirstIndex <= 9) {\r\n                        lwg.Admin.openCustomName = 'UIMain_00' + this.listFirstIndex;\r\n                    }\r\n                    else if (9 < this.listFirstIndex || this.listFirstIndex <= 99) {\r\n                        lwg.Admin.openCustomName = 'UIMain_0' + this.listFirstIndex;\r\n                    }\r\n                    lwg.Admin.openLevelNum = this.listFirstIndex;\r\n                    lwg.Admin._openScene(lwg.Admin.SceneName.UIPifuTry, null, null, null);\r\n                }\r\n                else {\r\n                    this.openPlayScene();\r\n                }\r\n            }\r\n        }\r\n    }\r\n    openPlayScene() {\r\n        lwg.Global._execution -= 2;\r\n        let num = lwg.Global.ExecutionNumNode.getChildByName('Num');\r\n        num.value = lwg.Global._execution.toString();\r\n        lwg.Global._createHint_01(lwg.Enum.HintType.consumeEx);\r\n        lwg.Global.createConsumeEx(null);\r\n        lwg.LocalStorage.addData();\r\n        lwg.Admin._openNumCustom(this.listFirstIndex);\r\n        this.self.close();\r\n    }\r\n    openPlayScene_exemptEx() {\r\n        lwg.Admin._openNumCustom(this.listFirstIndex);\r\n        this.self.close();\r\n    }\r\n    btnLocationUp(event) {\r\n        event.currentTarget.scale(1, 1);\r\n        this.listFirstIndex = lwg.Global._gameLevel;\r\n        this.CustomsList.refresh();\r\n        this.createAddHouse();\r\n    }\r\n    cellStyle(cell) {\r\n        let pic = cell.getChildByName('pic');\r\n        if (this.listFirstIndex % 2 == 0) {\r\n            pic.skin = 'UI_new/GameStart/icon_box01_open.png';\r\n        }\r\n        else {\r\n            pic.skin = 'UI_new/GameStart/icon_box02_open.png';\r\n        }\r\n        let lock = pic.getChildByName('lock');\r\n        if (this.listFirstIndex > lwg.Global._gameLevel) {\r\n            lock.visible = true;\r\n        }\r\n        else {\r\n            lock.visible = false;\r\n        }\r\n    }\r\n    customsListUp() {\r\n    }\r\n    lwgDisable() {\r\n        ADManager.CloseBanner();\r\n        Laya.MouseManager.multiTouchEnabled = false;\r\n    }\r\n}\r\n",
  "references": [
    "D:/Game/project/Riddle/Riddle1/TJ3Demo_Promo/src/script/Lwg_Template/lwg.ts",
    "D:/Game/project/Riddle/Riddle1/TJ3Demo_Promo/src/script/Game/UIMain.ts",
    "D:/Game/project/Riddle/Riddle1/TJ3Demo_Promo/src/TJ/RecordManager.ts",
    "D:/Game/project/Riddle/Riddle1/TJ3Demo_Promo/src/TJ/Admanager.ts"
  ]
}
